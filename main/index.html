<!DOCTYPE html>
<html class="writer-html5" lang="zh" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Future Re" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>主程序 - NewScanmem Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u4e3b\u7a0b\u5e8f";
        var mkdocs_page_input_path = "main.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> NewScanmem Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" title="在此输入需要搜索的内容" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航栏">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">首页</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../API_REFERENCE/">API 参考</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../endianness/">大端小端</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">主程序</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">概述</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">文件结构</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_4">当前实现</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_5">计划功能</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_6">命令行界面</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_7">集成点</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_8">使用示例</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_9">基本执行</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_10">开发路线图</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_11">第一阶段：基本框架</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_12">第二阶段：高级功能</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_13">第三阶段：优化</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_14">第四阶段：用户界面/用户体验</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_15">模块集成</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_16">进程检查器集成</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_17">内存扫描集成</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_18">值类型处理</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_19">消息系统集成</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_20">命令行参数设计</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_21">基本参数</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_22">参数解析</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_23">错误处理</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_24">参数验证</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_25">进程验证</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_26">性能考虑</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_27">内存使用</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_28">并行处理</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_29">进度报告</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_30">配置管理</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_31">配置文件支持</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_32">环境变量</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_33">测试和调试</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_34">单元测试</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_35">调试工具</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_36">未来扩展</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_37">插件系统</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_38">网络支持</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#gui">GUI 界面</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cli-repl">CLI 和 REPL 集成</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../maps/">内存映射</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../process_checker/">进程检查器</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../sets/">集合</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../show_message/">显示消息</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../target_mem/">目标内存</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../value/">值</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../NamingConvention/">命名规则</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="移动导航栏">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">NewScanmem Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="文档"></a></li>
      <li class="breadcrumb-item active">主程序</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/future-re/NewScanmem/edit/master/docs/main.md" class="icon icon-github"> 在GitHub上编辑</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">主应用文档</h1>
<h2 id="_2">概述</h2>
<p><code>main.cpp</code> 文件作为 NewScanmem 应用程序的入口点。它演示了基本的模块集成，并为内存扫描工具提供了基础框架。</p>
<h2 id="_3">文件结构</h2>
<pre><code class="language-cpp">import sets;

int main() {
    Set val;
    return 0;
}
</code></pre>
<h2 id="_4">当前实现</h2>
<p>当前的主函数是最小化的，作为以下功能的占位符：</p>
<ol>
<li><strong>模块集成测试</strong>: 演示 <code>sets</code> 模块可以成功导入和使用</li>
<li><strong>基本框架</strong>: 为应用程序开发提供起点</li>
<li><strong>编译验证</strong>: 确保所有模块能够正确编译在一起</li>
</ol>
<h2 id="_5">计划功能</h2>
<h3 id="_6">命令行界面</h3>
<pre><code class="language-cpp">// 未来实现
int main(int argc, char* argv[]) {
    // 解析命令行参数
    // 初始化模块
    // 开始内存扫描
    // 显示结果
}
</code></pre>
<h3 id="_7">集成点</h3>
<p>主应用程序将集成所有模块：</p>
<ol>
<li><strong>进程管理</strong> (process_checker)</li>
<li>目标进程选择</li>
<li>进程状态监控</li>
<li>
<p>权限检查</p>
</li>
<li>
<p><strong>内存分析</strong> (targetmem)</p>
</li>
<li>内存区域扫描</li>
<li>值匹配</li>
<li>
<p>模式检测</p>
</li>
<li>
<p><strong>数据类型</strong> (value)</p>
</li>
<li>多类型值支持</li>
<li>字节序处理</li>
<li>
<p>字节数组操作</p>
</li>
<li>
<p><strong>实用工具</strong> (sets, endianness, show_message)</p>
</li>
<li>结果集合操作</li>
<li>字节序转换</li>
<li>用户消息和日志</li>
</ol>
<h2 id="_8">使用示例</h2>
<h3 id="_9">基本执行</h3>
<pre><code class="language-bash"># 当前用法
./newscanmem

# 未来用法示例
./newscanmem --pid 1234 --type int32 --value 42
./newscanmem --pid 1234 --range 0x1000-0x2000 --string &quot;hello&quot;
./newscanmem --pid 1234 --float --tolerance 0.001
</code></pre>
<h2 id="_10">开发路线图</h2>
<h3 id="_11">第一阶段：基本框架</h3>
<ul>
<li>[ ] 命令行参数解析</li>
<li>[ ] 进程选择和验证</li>
<li>[ ] 基本内存扫描</li>
<li>[ ] 结果显示</li>
</ul>
<h3 id="_12">第二阶段：高级功能</h3>
<ul>
<li>[ ] 多值类型支持</li>
<li>[ ] 内存区域过滤</li>
<li>[ ] 模式匹配</li>
<li>[ ] 交互模式</li>
</ul>
<h3 id="_13">第三阶段：优化</h3>
<ul>
<li>[ ] 性能调优</li>
<li>[ ] 内存使用优化</li>
<li>[ ] 并行处理</li>
<li>[ ] 结果缓存</li>
</ul>
<h3 id="_14">第四阶段：用户界面/用户体验</h3>
<ul>
<li>[ ] 进度指示器</li>
<li>[ ] 彩色输出</li>
<li>[ ] 交互式界面</li>
<li>[ ] 配置文件支持</li>
</ul>
<h2 id="_15">模块集成</h2>
<h3 id="_16">进程检查器集成</h3>
<pre><code class="language-cpp">import process_checker;

// 检查目标进程状态
pid_t targetPid = 1234;
ProcessState state = ProcessChecker::check_process(targetPid);

if (state == ProcessState::RUNNING) {
    std::cout &lt;&lt; &quot;进程正在运行&quot; &lt;&lt; std::endl;
} else {
    std::cout &lt;&lt; &quot;进程未运行或无法访问&quot; &lt;&lt; std::endl;
    return 1;
}
</code></pre>
<h3 id="_17">内存扫描集成</h3>
<pre><code class="language-cpp">import targetmem;

// 创建内存匹配数组
MatchesAndOldValuesArray matches;

// 执行内存扫描
// ... 扫描逻辑 ...

// 显示结果
for (const auto&amp; swath : matches.swaths) {
    std::cout &lt;&lt; &quot;找到匹配的内存区域&quot; &lt;&lt; std::endl;
}
</code></pre>
<h3 id="_18">值类型处理</h3>
<pre><code class="language-cpp">import value;

// 创建搜索值
Value searchValue;
searchValue.setScalarTyped&lt;int32_t&gt;(42);
searchValue.flags = MatchFlags::S32B;

// 执行值匹配
// ... 匹配逻辑 ...
</code></pre>
<h3 id="_19">消息系统集成</h3>
<pre><code class="language-cpp">import show_message;

// 创建消息打印机
MessageContext ctx;
ctx.debugMode = true;
MessagePrinter printer(ctx);

printer.info(&quot;开始内存扫描&quot;);
printer.debug(&quot;调试信息: 扫描参数&quot;);
printer.warn(&quot;警告: 内存使用率较高&quot;);
</code></pre>
<h2 id="_20">命令行参数设计</h2>
<h3 id="_21">基本参数</h3>
<pre><code class="language-cpp">struct CommandLineArgs {
    pid_t targetPid = 0;           // 目标进程 ID
    std::string valueType = &quot;int32&quot;; // 值类型
    std::string searchValue;       // 搜索值
    std::string memoryRange;       // 内存范围
    bool debugMode = false;        // 调试模式
    bool verbose = false;          // 详细输出
};
</code></pre>
<h3 id="_22">参数解析</h3>
<pre><code class="language-cpp">// 解析命令行参数
CommandLineArgs parseArgs(int argc, char* argv[]) {
    CommandLineArgs args;

    for (int i = 1; i &lt; argc; ++i) {
        std::string arg = argv[i];

        if (arg == &quot;--pid&quot; &amp;&amp; i + 1 &lt; argc) {
            args.targetPid = std::stoi(argv[++i]);
        } else if (arg == &quot;--type&quot; &amp;&amp; i + 1 &lt; argc) {
            args.valueType = argv[++i];
        } else if (arg == &quot;--value&quot; &amp;&amp; i + 1 &lt; argc) {
            args.searchValue = argv[++i];
        } else if (arg == &quot;--range&quot; &amp;&amp; i + 1 &lt; argc) {
            args.memoryRange = argv[++i];
        } else if (arg == &quot;--debug&quot;) {
            args.debugMode = true;
        } else if (arg == &quot;--verbose&quot;) {
            args.verbose = true;
        }
    }

    return args;
}
</code></pre>
<h2 id="_23">错误处理</h2>
<h3 id="_24">参数验证</h3>
<pre><code class="language-cpp">bool validateArgs(const CommandLineArgs&amp; args) {
    if (args.targetPid &lt;= 0) {
        std::cerr &lt;&lt; &quot;错误: 无效的进程 ID&quot; &lt;&lt; std::endl;
        return false;
    }

    if (args.searchValue.empty()) {
        std::cerr &lt;&lt; &quot;错误: 未指定搜索值&quot; &lt;&lt; std::endl;
        return false;
    }

    return true;
}
</code></pre>
<h3 id="_25">进程验证</h3>
<pre><code class="language-cpp">bool validateProcess(pid_t pid) {
    ProcessState state = ProcessChecker::check_process(pid);

    if (state == ProcessState::DEAD) {
        std::cerr &lt;&lt; &quot;错误: 进程不存在&quot; &lt;&lt; std::endl;
        return false;
    }

    if (state == ProcessState::ERROR) {
        std::cerr &lt;&lt; &quot;错误: 无法访问进程&quot; &lt;&lt; std::endl;
        return false;
    }

    return true;
}
</code></pre>
<h2 id="_26">性能考虑</h2>
<h3 id="_27">内存使用</h3>
<ol>
<li><strong>流式处理</strong>: 避免一次性加载大量数据</li>
<li><strong>内存映射</strong>: 使用内存映射文件处理大文件</li>
<li><strong>缓存策略</strong>: 实现智能缓存减少重复计算</li>
</ol>
<h3 id="_28">并行处理</h3>
<pre><code class="language-cpp">// 并行扫描多个内存区域
void parallelScan(const std::vector&lt;MemoryRegion&gt;&amp; regions) {
    std::vector&lt;std::thread&gt; threads;

    for (const auto&amp; region : regions) {
        threads.emplace_back([region]() {
            scanRegion(region);
        });
    }

    for (auto&amp; thread : threads) {
        thread.join();
    }
}
</code></pre>
<h3 id="_29">进度报告</h3>
<pre><code class="language-cpp">class ProgressReporter {
private:
    size_t m_total;
    size_t m_current;
    std::chrono::steady_clock::time_point m_start;

public:
    ProgressReporter(size_t total) : m_total(total), m_current(0) {
        m_start = std::chrono::steady_clock::now();
    }

    void update(size_t increment = 1) {
        m_current += increment;

        auto now = std::chrono::steady_clock::now();
        auto elapsed = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(now - m_start);

        float progress = static_cast&lt;float&gt;(m_current) / m_total * 100.0f;
        std::cout &lt;&lt; &quot;\r进度: &quot; &lt;&lt; std::fixed &lt;&lt; std::setprecision(1) 
                  &lt;&lt; progress &lt;&lt; &quot;% (&quot; &lt;&lt; m_current &lt;&lt; &quot;/&quot; &lt;&lt; m_total &lt;&lt; &quot;)&quot; 
                  &lt;&lt; std::flush;
    }
};
</code></pre>
<h2 id="_30">配置管理</h2>
<h3 id="_31">配置文件支持</h3>
<pre><code class="language-cpp">struct Config {
    bool debugMode = false;
    bool verbose = false;
    size_t maxResults = 1000;
    std::string logFile;
    std::map&lt;std::string, std::string&gt; customSettings;
};

Config loadConfig(const std::string&amp; configFile) {
    Config config;
    // 从文件加载配置
    return config;
}
</code></pre>
<h3 id="_32">环境变量</h3>
<pre><code class="language-cpp">void loadEnvironmentConfig() {
    if (const char* debug = std::getenv(&quot;NEWSCANMEM_DEBUG&quot;)) {
        if (std::string(debug) == &quot;1&quot;) {
            // 启用调试模式
        }
    }
}
</code></pre>
<h2 id="_33">测试和调试</h2>
<h3 id="_34">单元测试</h3>
<pre><code class="language-cpp">// 测试模块集成
void testModuleIntegration() {
    // 测试 sets 模块
    Set testSet;
    assert(testSet.size() == 0);

    // 测试 value 模块
    Value testValue;
    testValue.value = static_cast&lt;int32_t&gt;(42);
    assert(std::holds_alternative&lt;int32_t&gt;(testValue.value));
}
</code></pre>
<h3 id="_35">调试工具</h3>
<pre><code class="language-cpp">class DebugHelper {
public:
    static void dumpMemory(const void* addr, size_t size) {
        const uint8_t* bytes = static_cast&lt;const uint8_t*&gt;(addr);

        for (size_t i = 0; i &lt; size; ++i) {
            if (i % 16 == 0) {
                std::cout &lt;&lt; std::endl &lt;&lt; std::hex &lt;&lt; std::setw(8) 
                          &lt;&lt; std::setfill('0') &lt;&lt; i &lt;&lt; &quot;: &quot;;
            }
            std::cout &lt;&lt; std::hex &lt;&lt; std::setw(2) &lt;&lt; std::setfill('0') 
                      &lt;&lt; static_cast&lt;int&gt;(bytes[i]) &lt;&lt; &quot; &quot;;
        }
        std::cout &lt;&lt; std::endl;
    }
};
</code></pre>
<h2 id="_36">未来扩展</h2>
<h3 id="_37">插件系统</h3>
<pre><code class="language-cpp">// 插件接口
class ScanPlugin {
public:
    virtual bool initialize() = 0;
    virtual bool scan(const MemoryRegion&amp; region) = 0;
    virtual void cleanup() = 0;
    virtual std::string getName() const = 0;
};

// 插件管理器
class PluginManager {
private:
    std::vector&lt;std::unique_ptr&lt;ScanPlugin&gt;&gt; m_plugins;

public:
    void registerPlugin(std::unique_ptr&lt;ScanPlugin&gt; plugin);
    void runPlugins(const MemoryRegion&amp; region);
};
</code></pre>
<h3 id="_38">网络支持</h3>
<pre><code class="language-cpp">// 远程扫描支持
class RemoteScanner {
public:
    bool connect(const std::string&amp; host, int port);
    bool scanRemoteProcess(pid_t pid);
    std::vector&lt;MemoryMatch&gt; getResults();
};
</code></pre>
<h3 id="gui">GUI 界面</h3>
<pre><code class="language-cpp">// 图形用户界面（未来计划）
class MainWindow {
public:
    void showProcessList();
    void showScanResults();
    void showMemoryMap();
};
</code></pre>
<h3 id="cli-repl">CLI 和 REPL 集成</h3>
<p>主应用程序现已集成命令行界面 (CLI) 和 REPL 循环。这允许用户交互式地执行内存扫描和分析命令。<code>main.cpp</code> 文件初始化 REPL 并注册了 <code>help</code>、<code>quit</code> 和 <code>pid</code> 等命令。</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="页脚导航">
        <a href="../endianness/" class="btn btn-neutral float-left" title="大端小端"><span class="icon icon-circle-arrow-left"></span> 上一章</a>
        <a href="../maps/" class="btn btn-neutral float-right" title="内存映射">下一章 <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  用<a href="https://www.mkdocs.org/">MkDocs</a>构建，使用<a href="https://readthedocs.org">Read the Docs</a>提供的<a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>。
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="版本">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/future-re/NewScanmem" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../endianness/" style="color: #fcfcfc">&laquo; 上一章</a></span>
    
    
      <span><a href="../maps/" style="color: #fcfcfc">下一章 &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
